# Spring Boot Coverage Boost Rules (Hybrid Mode)

You are an expert Java developer. Goal: Increase LINE COVERAGE to 80% without breaking existing logic.

## 1. Mandatory Memory & State Persistence
- **Primary Source of Truth:** Always read `COVERAGE_PROGRESS.md` first.
- **Mandatory Update:** Update `COVERAGE_PROGRESS.md` immediately after any test passes.
- **Context Management:** Summarize status before ending a session to allow 128k context reset.

## 2. Testing Strategy: Preservation + Expansion
- **Preserve Existing Tests:** - **DO NOT** modify or delete existing Unit Tests (Mockito based) unless they are failing.
    - If a class already has a `[ClassName]Test.java`, leave it alone.
- **New Coverage Strategy (The "Full Stack" Hit):**
    - To fill coverage gaps RAPIDLY, create **NEW** integration tests named `[ClassName]IT.java` or `[ClassName]IntegrationTest.java`.
    - **Prefer `@SpringBootTest` + `@AutoConfigureMockMvc`** for new tests to cover Controller/Service/Repo layers in one flow.
- **Metric:** Focus ONLY on maximizing **LINE COVERAGE**. Do not waste tokens on complex branch logic unless required to reach the 80% goal.
- **Mocks:** Use real beans/H2 for new Integration Tests. Use `@MockBean` only for external APIs (e.g., Cloud services, Payment gateways).

## 3. Technical Standards
- **Frameworks:** JUnit 5, Mockito, AssertJ, MockMvc.
- **Environment:** Windows, JDK 17.
- **Commands:** Use `$env:JAVA_HOME = "C:\Program Files\Java\jdk-17"; E:\maven-mvnd-1.0.3-windows-amd64\bin\mvnd.cmd clean test -Dtest=ClassName`
- **Clean Code:** No verbose Javadoc. Keep test methods descriptive but concise.

## 4. Execution Workflow
1. **Analyze:** Check `COVERAGE_PROGRESS.md` for classes with < 80% line coverage.
2. **Read:** Examine the target class AND its existing test file (if any).
3. **Decision:** - If coverage is low, **CREATE A NEW Integration Test (`IT.java`)** instead of refactoring the existing Unit Test.
4. **Verify:** Execute the specific test using the provided `mvnd` command.
5. **Update & Commit:** Update `COVERAGE_PROGRESS.md`, then git commit using DeepSeek to describe the changes.

## 5. Handling Edge Cases
- For new Integration Tests, focus on "Happy Path" first as it covers the most lines.
- Only address `null` or `Exception` cases if line coverage is still below 80% after happy path tests.